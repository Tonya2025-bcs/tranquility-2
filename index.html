// Save this as: src/App.js or pages/index.js (depending on your setup)

import React, { useState, useEffect } from 'react';

const TraumaInformedResetApp = () => {
  const [isPlaying, setIsPlaying] = useState(false);
  const [currentStep, setCurrentStep] = useState(0);
  const [timeLeft, setTimeLeft] = useState(10 * 60);
  const [selectedReset, setSelectedReset] = useState('grounding');
  const [showSafetyReminder, setShowSafetyReminder] = useState(true);
  const [sessionComplete, setSessionComplete] = useState(false);

  const resetTypes = {
    grounding: {
      name: "Grounding & Safety",
      description: "Find your footing and feel secure in the present moment",
      steps: [
        "Notice you are safe in this moment. You have complete control.",
        "Feel your feet on the ground. Notice 5 things you can see around you.",
        "Take a breath only as deep as feels comfortable right now.",
        "Notice 4 things you can touch. Feel their texture and temperature.",
        "Allow your nervous system to recognize safety in this space.",
        "Remember: You can pause or stop anytime. You are in control."
      ]
    },
    soothing: {
      name: "Gentle Soothing",
      description: "Offer yourself compassion and tender care",
      steps: [
        "Place your hands wherever feels most comforting - heart, stomach, or lap.",
        "Breathe naturally. There's no need to change or fix anything.",
        "Send yourself compassion for whatever you're experiencing right now.",
        "Your nervous system is working hard to protect you.",
        "You are deserving of comfort, care, and gentleness.",
        "Rest in this moment of self-compassion and acceptance."
      ]
    },
    activation: {
      name: "Gentle Activation",
      description: "Reconnect with your strength and vitality",
      steps: [
        "Gently stretch your arms above your head if it feels right.",
        "Roll your shoulders slowly backward, releasing any tension.",
        "Take up space in a way that feels safe and empowering.",
        "Notice your inherent strength and remarkable resilience.",
        "Acknowledge: You survived. You are here. You are enough.",
        "Feel your aliveness, your presence, your unshakeable worth."
      ]
    }
  };

  const affirmations = {
    grounding: [
      "I am safe in this moment",
      "I trust my ability to care for myself",
      "My feelings are valid and important"
    ],
    soothing: [
      "I deserve compassion and kindness",
      "I am worthy of gentleness",
      "I honor my healing journey"
    ],
    activation: [
      "I am resilient and strong",
      "I have survived difficult things before",
      "I choose to honor my experience"
    ]
  };

  useEffect(() => {
    let interval;
    if (isPlaying && timeLeft > 0) {
      interval = setInterval(() => {
        setTimeLeft(prev => {
          if (prev <= 1) {
            setIsPlaying(false);
            setSessionComplete(true);
            return 0;
          }
          return prev - 1;
        });
      }, 1000);
    }
    return () => clearInterval(interval);
  }, [isPlaying, timeLeft]);

  const togglePlay = () => {
    setIsPlaying(!isPlaying);
    setSessionComplete(false);
  };

  const resetSession = () => {
    setIsPlaying(false);
    setCurrentStep(0);
    setTimeLeft(10 * 60);
    setSessionComplete(false);
  };

  const nextStep = () => {
    if (currentStep < resetTypes[selectedReset].steps.length - 1) {
      setCurrentStep(currentStep + 1);
    }
  };

  const prevStep = () => {
    if (currentStep > 0) {
      setCurrentStep(currentStep - 1);
    }
  };

  const formatTime = (seconds) => {
    const mins = Math.floor(seconds / 60);
    const secs = seconds % 60;
    return `${mins}:${secs.toString().padStart(2, '0')}`;
  };

  const currentResetType = resetTypes[selectedReset];

  const styles = {
    container: {
      backgroundColor: '#E8E2D5',
      maxWidth: '28rem',
      margin: '0 auto',
      minHeight: '100vh',
      padding: '1.5rem',
      fontFamily: 'system-ui, -apple-system, sans-serif'
    },
    card: {
      backgroundColor: 'white',
      borderRadius: '1.5rem',
      padding: '1.5rem',
      marginBottom: '2rem',
      boxShadow: '0 10px 25px rgba(0,0,0,0.1)',
      border: '2px solid #D4AF37'
    },
    button: {
      backgroundColor: '#2D5016',
      color: 'white',
      border: 'none',
      borderRadius: '1rem',
      padding: '0.75rem 1.5rem',
      fontWeight: 'bold',
      cursor: 'pointer',
      transition: 'all 0.3s ease',
      boxShadow: '0 4px 15px rgba(45, 80, 22, 0.3)'
    },
    resetButton: {
      backgroundColor: 'white',
      color: '#2D5016',
      border: '2px solid #D4AF37',
      borderRadius: '1rem',
      padding: '0.75rem 1.5rem',
      fontWeight: 'bold',
      cursor: 'pointer',
      transition: 'all 0.3s ease'
    },
    title: {
      color: '#2D5016',
      fontSize: '2.5rem',
      fontWeight: '900',
      textAlign: 'center',
      marginBottom: '1rem'
    },
    stepText: {
      color: '#2D5016',
      fontSize: '1.25rem',
      lineHeight: '1.6',
      textAlign: 'center',
      marginBottom: '2rem'
    },
    timer: {
      color: '#2D5016',
      fontSize: '3rem',
      fontWeight: '900',
      textAlign: 'center',
      marginBottom: '1rem'
    },
    progressBar: {
      width: '100%',
      height: '0.75rem',
      backgroundColor: 'white',
      borderRadius: '0.5rem',
      overflow: 'hidden',
      border: '2px solid #D4AF37',
      marginBottom: '2rem'
    },
    progress: {
      height: '100%',
      background: 'linear-gradient(90deg, #2D5016 0%, #D4AF37 50%, #2D5016 100%)',
      transition: 'width 0.5s ease'
    }
  };

  return (
    <div style={styles.container}>
      {/* Safety Notice */}
      {showSafetyReminder && (
        <div style={styles.card}>
          <h3 style={{color: '#2D5016', fontWeight: 'bold', marginBottom: '1rem'}}>
            Your Safety Comes First
          </h3>
          <p style={{color: '#2D5016', marginBottom: '1rem', opacity: 0.8}}>
            This is your space. You can pause, skip, or stop at any time. Only engage with what feels safe and comfortable for you.
          </p>
          <button 
            style={styles.button}
            onClick={() => setShowSafetyReminder(false)}
          >
            I understand ✓
          </button>
        </div>
      )}

      {/* Header */}
      <div style={{textAlign: 'center', marginBottom: '2rem'}}>
        <h1 style={styles.title}>
          TRANQUILITY<span style={{color: '#D4AF37'}}>™</span>
        </h1>
        <div style={{
          width: '8rem',
          height: '0.25rem',
          margin: '0 auto 0.5rem',
          borderRadius: '0.5rem',
          background: 'linear-gradient(90deg, #D4AF37 0%, #2D5016 50%, #D4AF37 100%)'
        }}></div>
        <p style={{color: '#2D5016', opacity: 0.7}}>
          Soothe the Nervous System, Feel the Calm
        </p>
      </div>

      {/* Session Complete */}
      {sessionComplete && (
        <div style={styles.card}>
          <div style={{textAlign: 'center'}}>
            <h3 style={{color: '#2D5016', fontWeight: 'bold', marginBottom: '1rem'}}>
              Session Complete
            </h3>
            <p style={{color: '#2D5016', marginBottom: '1rem', opacity: 0.8}}>
              You've taken time to care for yourself. That's something to be proud of.
            </p>
            <button style={styles.button} onClick={resetSession}>
              Start New Session
            </button>
          </div>
        </div>
      )}

      {/* Reset Type Selection */}
      <div style={{marginBottom: '2rem'}}>
        <p style={{color: '#2D5016', fontWeight: 'bold', textAlign: 'center', marginBottom: '1rem'}}>
          Choose your reset approach:
        </p>
        <div style={{display: 'flex', flexDirection: 'column', gap: '1rem'}}>
          {Object.entries(resetTypes).map(([key, reset]) => (
            <button
              key={key}
              onClick={() => setSelectedReset(key)}
              style={{
                backgroundColor: selectedReset === key ? '#2D5016' : 'white',
                color: selectedReset === key ? 'white' : '#2D5016',
                border: `2px solid ${selectedReset === key ? '#D4AF37' : '#D4AF3780'}`,
                borderRadius: '1rem',
                padding: '1rem',
                cursor: 'pointer',
                transition: 'all 0.3s ease',
                textAlign: 'left'
              }}
            >
              <div style={{fontWeight: 'bold', fontSize: '1.125rem', marginBottom: '0.25rem'}}>
                {reset.name}
              </div>
              <div style={{fontSize: '0.875rem', opacity: 0.8}}>
                {reset.description}
              </div>
            </button>
          ))}
        </div>
      </div>

      {/* Timer */}
      <div style={{textAlign: 'center', marginBottom: '2rem'}}>
        <div style={styles.timer}>{formatTime(timeLeft)}</div>
        <div style={styles.progressBar}>
          <div 
            style={{
              ...styles.progress,
              width: `${((10 * 60 - timeLeft) / (10 * 60)) * 100}%`
            }}
          />
        </div>
      </div>

      {/* Current Step */}
      <div style={styles.card}>
        <div style={{textAlign: 'center', marginBottom: '1rem'}}>
          <span style={{
            backgroundColor: '#2D5016',
            color: 'white',
            padding: '0.5rem 1rem',
            borderRadius: '0.75rem',
            fontSize: '0.875rem',
            fontWeight: 'bold'
          }}>
            Step {currentStep + 1} of {currentResetType.steps.length}
          </span>
        </div>
        
        <p style={styles.stepText}>
          {currentResetType.steps[currentStep]}
        </p>
        
        {/* Navigation */}
        <div style={{display: 'flex', justifyContent: 'space-between', alignItems: 'center'}}>
          <button
            onClick={prevStep}
            disabled={currentStep === 0}
            style={{
              ...styles.button,
              opacity: currentStep === 0 ? 0.3 : 1,
              cursor: currentStep === 0 ? 'not-allowed' : 'pointer'
            }}
          >
            ← Previous
          </button>
          
          <div style={{display: 'flex', gap: '0.5rem'}}>
            {currentResetType.steps.map((_, index) => (
              <div
                key={index}
                style={{
                  width: '0.5rem',
                  height: '0.5rem',
                  borderRadius: '50%',
                  backgroundColor: index === currentStep ? '#D4AF37' : '#4A674160'
                }}
              />
            ))}
          </div>
          
          <button
            onClick={nextStep}
            disabled={currentStep === currentResetType.steps.length - 1}
            style={{
              ...styles.button,
              opacity: currentStep === currentResetType.steps.length - 1 ? 0.3 : 1,
              cursor: currentStep === currentResetType.steps.length - 1 ? 'not-allowed' : 'pointer'
            }}
          >
            Next →
          </button>
        </div>
      </div>

      {/* Controls */}
      <div style={{display: 'flex', justifyContent: 'center', gap: '1rem', marginBottom: '2rem'}}>
        <button onClick={togglePlay} style={styles.button}>
          {isPlaying ? '⏸ Pause' : '▶ Start'}
        </button>
        <button onClick={resetSession} style={styles.resetButton}>
          ↻ Reset
        </button>
      </div>

      {/* Affirmations */}
      <div style={styles.card}>
        <h3 style={{color: '#2D5016', fontWeight: 'bold', textAlign: 'center', marginBottom: '1.5rem'}}>
          Gentle Reminders
        </h3>
        <div style={{display: 'flex', flexDirection: 'column', gap: '1rem'}}>
          {affirmations[selectedReset].map((affirmation, index) => (
            <div 
              key={index} 
              style={{
                backgroundColor: '#D4AF3730',
                border: '1px solid #D4AF3760',
                borderRadius: '0.75rem',
                padding: '1rem',
                color: '#2D5016',
                fontStyle: 'italic'
              }}
            >
              🌿 {affirmation}
            </div>
          ))}
        </div>
      </div>

      {/* Footer */}
      <div style={{textAlign: 'center', fontSize: '0.75rem', color: '#2D5016', opacity: 0.6, marginTop: '2rem'}}>
        <p>This is not a substitute for professional mental health care.</p>
        <p>If you're in crisis, please reach out to a mental health professional.</p>
        <p style={{fontWeight: 'bold', marginTop: '1rem'}}>© 2025 Tranquility. All rights reserved.</p>
      </div>
    </div>
  );
};

export default TraumaInformedResetApp;