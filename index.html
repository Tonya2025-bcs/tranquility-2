<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tranquility - Trauma-Informed Reset</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background-color: #E8E2D5;
            line-height: 1.6;
        }
        
        .container {
            max-width: 28rem;
            margin: 0 auto;
            min-height: 100vh;
            padding: 1.5rem;
        }

        /* Tranquil Landscape Header */
        .landscape-container {
            position: relative;
            width: 100%;
            height: 300px;
            margin-bottom: 2rem;
            border-radius: 1.5rem;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            border: 3px solid #D4AF37;
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.6);
        }

        .landscape-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(1px);
            z-index: 15;
        }

        .landscape-overlay .title {
            color: white;
            font-size: 2.8rem;
            font-weight: 900;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            margin-bottom: 0.5rem;
            z-index: 10;
        }

        .landscape-overlay .trademark {
            color: #D4AF37;
            font-size: 1.8rem;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }

        .landscape-overlay .subtitle {
            color: white;
            font-size: 1.1rem;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
            opacity: 0.9;
        }

        .landscape-overlay .gradient-line {
            width: 8rem;
            height: 0.25rem;
            margin: 0 auto 0.5rem;
            border-radius: 0.5rem;
            background: linear-gradient(90deg, #c0c0c0 0%, #ffffff 50%, #c0c0c0 100%);
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        /* Gold border enhancement for header */
        .gold-border-1 {
            position: absolute;
            top: -3px;
            left: -3px;
            right: -3px;
            bottom: -3px;
            border: 2px solid #FFD700;
            border-radius: 1.5rem;
            pointer-events: none;
            z-index: 5;
        }

        .gold-border-2 {
            position: absolute;
            top: -6px;
            left: -6px;
            right: -6px;
            bottom: -6px;
            border: 1px solid #FFA500;
            border-radius: 1.5rem;
            pointer-events: none;
            opacity: 0.6;
            z-index: 4;
        }

        .card {
            background: linear-gradient(145deg, #9CAF88 0%, #A8BA94 25%, #B4C5A0 50%, #C0D0AC 75%, #CCDBB8 100%);
            border-radius: 1.5rem;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 
                inset -2px -2px 6px rgba(255,255,255,0.7),
                inset 2px 2px 6px rgba(0,0,0,0.15),
                0 8px 20px rgba(0,0,0,0.1);
            border: 2px solid #87a173;
            color: #000000;
        }
        
        .button {
            background-color: #2D5016;
            color: white;
            border: none;
            border-radius: 1rem;
            padding: 0.75rem 1.5rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(45, 80, 22, 0.3);
            font-size: 1rem;
        }
        
        .button:hover {
            opacity: 0.9;
            transform: scale(1.02);
        }
        
        .button:disabled {
            opacity: 0.3;
            cursor: not-allowed;
            transform: none;
        }
        
        .reset-button {
            background-color: white;
            color: #2D5016;
            border: 2px solid #D4AF37;
            border-radius: 1rem;
            padding: 0.75rem 1.5rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
        }
        
        .reset-button:hover {
            opacity: 0.9;
            transform: scale(1.02);
        }
        
        .timer {
            color: #000000;
            font-size: 3rem;
            font-weight: 900;
            text-align: center;
            margin-bottom: 1rem;
            text-shadow: 2px 2px 4px rgba(255,255,255,0.5);
        }
        
        .step-text {
            color: #000000;
            font-size: 1.25rem;
            line-height: 1.6;
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .progress-bar {
            width: 100%;
            height: 0.75rem;
            background-color: white;
            border-radius: 0.5rem;
            overflow: hidden;
            border: 2px solid #D4AF37;
            margin-bottom: 2rem;
        }
        
        .progress {
            height: 100%;
            background: linear-gradient(90deg, #2D5016 0%, #D4AF37 50%, #2D5016 100%);
            transition: width 0.5s ease;
            width: 0%;
        }
        
        .reset-option {
            background: linear-gradient(145deg, #9CAF88 0%, #A8BA94 50%, #B4C5A0 100%);
            color: #000000;
            border: 2px solid #87a173;
            box-shadow: inset -2px -2px 6px rgba(255,255,255,0.3), inset 2px 2px 6px rgba(0,0,0,0.1);
            border-radius: 1rem;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            width: 100%;
            margin-bottom: 1rem;
            display: block;
            font-size: 1rem;
        }
        
        .reset-option:hover {
            transform: scale(1.02);
        }
        
        .reset-option.selected {
            background: linear-gradient(145deg, #7a9470 0%, #869b7c 50%, #92a788 100%);
            border-color: #D4AF37;
            box-shadow: inset -3px -3px 8px rgba(255,255,255,0.4), inset 3px 3px 8px rgba(0,0,0,0.2);
        }
        
        .affirmation {
            background: linear-gradient(145deg, #9CAF88 0%, #A8BA94 50%, #B4C5A0 100%);
            border: 1px solid #87a173;
            border-radius: 0.75rem;
            padding: 1rem;
            color: #000000;
            font-style: italic;
            margin-bottom: 1rem;
            box-shadow: inset -2px -2px 6px rgba(255,255,255,0.3), inset 2px 2px 6px rgba(0,0,0,0.1);
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 2rem;
        }
        
        .navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .dots {
            display: flex;
            gap: 0.5rem;
        }
        
        .dot {
            width: 0.5rem;
            height: 0.5rem;
            border-radius: 50%;
            background-color: rgba(74, 103, 65, 0.4);
            transition: all 0.3s ease;
        }
        
        .dot.active {
            background-color: #D4AF37;
            box-shadow: 0 0 8px rgba(212, 175, 55, 0.8);
        }
        
        .hidden {
            display: none;
        }
        
        .step-badge {
            background: linear-gradient(145deg, #9CAF88 0%, #A8BA94 50%, #B4C5A0 100%);
            color: #000000;
            padding: 0.5rem 1rem;
            border-radius: 0.75rem;
            font-size: 0.875rem;
            font-weight: bold;
            display: inline-block;
            text-shadow: 1px 1px 2px rgba(255,255,255,0.5);
            box-shadow: inset -2px -2px 6px rgba(255,255,255,0.3), inset 2px 2px 6px rgba(0,0,0,0.1);
        }
        
        .option-title {
            font-weight: bold;
            font-size: 1.125rem;
            margin-bottom: 0.25rem;
            text-shadow: 1px 1px 2px rgba(255,255,255,0.5);
        }
        
        .option-desc {
            font-size: 0.875rem;
            opacity: 0.8;
        }
        
        .audio-controls {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .audio-btn {
            background-color: #4A6741;
            color: white;
            border: none;
            border-radius: 0.75rem;
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .audio-btn:hover {
            opacity: 0.9;
            transform: scale(1.02);
        }
        
        .audio-btn.active {
            background-color: #D4AF37;
            color: #2D5016;
        }
        
        .volume-control {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 1rem;
        }
        
        .volume-slider {
            width: 100px;
            height: 5px;
            border-radius: 5px;
            background: #D4AF37;
            outline: none;
            opacity: 0.7;
            transition: opacity 0.2s;
        }
        
        .volume-slider:hover {
            opacity: 1;
        }

        .step-timer-indicator {
            width: 100%;
            height: 3px;
            background-color: rgba(212, 175, 55, 0.3);
            border-radius: 2px;
            margin-bottom: 1rem;
            overflow: hidden;
        }

        .step-timer-progress {
            height: 100%;
            background-color: #D4AF37;
            transition: width 0.1s linear;
            width: 0%;
        }

        /* Responsive Design */
        @media (max-width: 480px) {
            .container { padding: 1rem; }
            .landscape-container { height: 250px; }
            .landscape-overlay .title { font-size: 2.2rem; }
            .landscape-overlay .trademark { font-size: 1.4rem; }
            .timer { font-size: 2.5rem; }
            .step-text { font-size: 1.1rem; }
            .controls { flex-direction: column; gap: 0.5rem; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Tranquil Header with Gold Border -->
        <div class="landscape-container">
            <!-- Gold border enhancement -->
            <div class="gold-border-1"></div>
            <div class="gold-border-2"></div>
            
            <!-- Beautiful 3D Sage Green Background -->
            <div style="width: 100%; height: 100%; background: 
                linear-gradient(135deg, #9CAF88 0%, #A8BA94 20%, #B4C5A0 40%, #C0D0AC 60%, #CCDBB8 80%, #D8E6C4 100%),
                linear-gradient(45deg, #87a173 0%, #93ad7f 50%, #9fb98b 100%); 
                background-blend-mode: multiply; position: relative;">
                
                <!-- 3D Depth layers -->
                <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; 
                    background: 
                        radial-gradient(ellipse at top left, rgba(255,255,255,0.15) 0%, transparent 50%),
                        radial-gradient(ellipse at bottom right, rgba(0,0,0,0.1) 0%, transparent 50%),
                        linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.08) 50%, transparent 70%);
                "></div>
                
                <!-- Subtle texture overlay -->
                <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; 
                    background: 
                        repeating-linear-gradient(45deg, 
                            transparent, 
                            transparent 2px, 
                            rgba(255,255,255,0.02) 2px, 
                            rgba(255,255,255,0.02) 4px),
                        repeating-linear-gradient(-45deg, 
                            transparent, 
                            transparent 2px, 
                            rgba(0,0,0,0.01) 2px, 
                            rgba(0,0,0,0.01) 4px);
                "></div>
            </div>
            
            <div class="landscape-overlay">
                <div style="position: relative; text-align: center;">
                    <!-- 3D Metallic Leaf positioned above the L -->
                    <svg viewBox="0 0 200 280" fill="none" xmlns="http://www.w3.org/2000/svg" style="
                        width: 3rem; 
                        height: 4rem; 
                        position: absolute;
                        top: -2.5rem;
                        left: calc(50% + 2.2rem);
                        transform: rotate(15deg) translateX(-50%);
                        filter: drop-shadow(0 8px 16px rgba(0,0,0,0.3));
                        z-index: 10;
                    ">
                        <defs>
                            <linearGradient id="metalGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" stop-color="#f8f9fa" />
                                <stop offset="15%" stop-color="#e9ecef" />
                                <stop offset="35%" stop-color="#dee2e6" />
                                <stop offset="50%" stop-color="#adb5bd" />
                                <stop offset="65%" stop-color="#6c757d" />
                                <stop offset="85%" stop-color="#495057" />
                                <stop offset="100%" stop-color="#343a40" />
                            </linearGradient>
                            <linearGradient id="leafHighlight" x1="20%" y1="20%" x2="80%" y2="80%">
                                <stop offset="0%" stop-color="#ffffff" stop-opacity="0.8" />
                                <stop offset="50%" stop-color="#f8f9fa" stop-opacity="0.3" />
                                <stop offset="100%" stop-color="#adb5bd" stop-opacity="0.1" />
                            </linearGradient>
                            <pattern id="brushedMetal" patternUnits="userSpaceOnUse" width="2" height="200" patternTransform="rotate(45)">
                                <rect width="1" height="200" fill="#dee2e6" opacity="0.3"/>
                                <rect x="1" width="1" height="200" fill="#6c757d" opacity="0.2"/>
                            </pattern>
                        </defs>
                        
                        <!-- Main leaf shape -->
                        <path d="M100 40 C 50 50, 30 90, 40 150 C 50 210, 90 250, 100 260 C 110 250, 150 210, 160 150 C 170 90, 150 50, 100 40 Z" 
                              fill="url(#metalGradient)" stroke="#495057" stroke-width="1"/>
                        
                        <!-- Brushed metal texture -->
                        <path d="M100 40 C 50 50, 30 90, 40 150 C 50 210, 90 250, 100 260 C 110 250, 150 210, 160 150 C 170 90, 150 50, 100 40 Z" 
                              fill="url(#brushedMetal)" opacity="0.6"/>
                        
                        <!-- Central vein -->
                        <path d="M100 70 L100 230" stroke="#495057" stroke-width="3" stroke-linecap="round" opacity="0.7"/>
                        
                        <!-- Side veins -->
                        <path d="M70 120 Q100 110, 130 120" stroke="#6c757d" stroke-width="2" stroke-linecap="round" fill="none" opacity="0.5"/>
                        <path d="M75 160 Q100 150, 125 160" stroke="#6c757d" stroke-width="2" stroke-linecap="round" fill="none" opacity="0.5"/>
                        <path d="M80 200 Q100 190, 120 200" stroke="#6c757d" stroke-width="2" stroke-linecap="round" fill="none" opacity="0.5"/>
                        
                        <!-- Highlight overlay -->
                        <path d="M100 40 C 50 50, 30 90, 40 150 C 50 210, 90 250, 100 260 C 110 250, 150 210, 160 150 C 170 90, 150 50, 100 40 Z" 
                              fill="url(#leafHighlight)"/>
                        
                        <!-- 3D Edge highlights -->
                        <path d="M100 40 C 70 45, 50 70, 45 110" stroke="#ffffff" stroke-width="2" stroke-linecap="round" fill="none" opacity="0.6"/>
                        <path d="M100 40 C 130 45, 150 70, 155 110" stroke="#343a40" stroke-width="1" stroke-linecap="round" fill="none" opacity="0.4"/>
                    </svg>
                    
                    <!-- 3D Embossed Text -->
                    <h1 style="
                        color: #c0c0c0;
                        font-size: 2.4rem;
                        font-weight: 900;
                        text-align: center;
                        margin: 0;
                        text-shadow: 
                            -2px -2px 4px rgba(255,255,255,0.8),
                            2px 2px 6px rgba(0,0,0,0.6),
                            0px 0px 0px rgba(180,180,180,1),
                            1px 1px 0px rgba(160,160,160,1),
                            2px 2px 0px rgba(140,140,140,1),
                            3px 3px 0px rgba(120,120,120,1);
                        letter-spacing: 0.1em;
                    ">
                        TRANQUILITY<span style="color: #D4AF37; font-size: 1.6rem;">™</span>
                    </h1>
                </div>
                <div class="gradient-line"></div>
                <p class="subtitle">Soothe the Nervous System, Feel the Calm</p>
            </div>
        </div>

        <!-- Safety Notice with 3D Sage Green -->
        <div id="safetyNotice" class="card">
            <h3 style="color: #2D5016; font-weight: bold; margin-bottom: 1rem; text-shadow: 1px 1px 2px rgba(255,255,255,0.5);">
                🛡️ Your Safety Comes First
            </h3>
            <p style="color: #000000; margin-bottom: 1rem; opacity: 0.9;">
                This is your space. You can pause, skip, or stop at any time. Only engage with what feels safe and comfortable for you.
            </p>
            <button class="button" onclick="hideSafetyNotice()" style="background-color: #D4AF37; color: #2D5016;">
                I understand ✓
            </button>
        </div>

        <!-- Session Complete -->
        <div id="sessionComplete" class="card hidden">
            <div style="text-align: center;">
                <h3 style="color: #2D5016; font-weight: bold; margin-bottom: 1rem; text-shadow: 1px 1px 2px rgba(255,255,255,0.5);">
                    ✨ Session Complete
                </h3>
                <p style="color: #000000; margin-bottom: 1rem; opacity: 0.9;">
                    You've taken time to care for yourself. That's something to be proud of.
                </p>
                <button class="button" onclick="resetSession()">
                    Start New Session
                </button>
            </div>
        </div>

        <!-- Audio Controls -->
        <div class="card">
            <h3 style="color: #2D5016; font-weight: bold; text-align: center; margin-bottom: 1rem; text-shadow: 1px 1px 2px rgba(255,255,255,0.5);">
                🎵 Audio Settings
            </h3>
            <div class="audio-controls">
                <button class="audio-btn" id="voiceBtn" onclick="toggleVoice()">
                    🎤 <span id="voiceText">Your Voice</span>
                </button>
                <button class="audio-btn" id="musicBtn" onclick="toggleMusic()">
                    🎹 <span id="musicText">Piano Music</span>
                </button>
            </div>
            <div class="volume-control" style="justify-content: center;">
                <span style="color: #000000; font-size: 0.875rem;">🔊</span>
                <input type="range" id="volumeSlider" class="volume-slider" min="0" max="100" value="50" onchange="updateVolume()">
            </div>
        </div>

        <!-- Reset Type Selection -->
        <div style="margin-bottom: 2rem;">
            <p style="color: #000000; font-weight: bold; text-align: center; margin-bottom: 1rem;">
                Choose your reset approach:
            </p>
            
            <button class="reset-option selected" data-type="grounding" onclick="selectReset('grounding')">
                <div class="option-title">🛡️ Grounding & Safety</div>
                <div class="option-desc">Find your footing and feel secure in the present moment</div>
            </button>
            
            <button class="reset-option" data-type="soothing" onclick="selectReset('soothing')">
                <div class="option-title">❤️ Gentle Soothing</div>
                <div class="option-desc">Offer yourself compassion and tender care</div>
            </button>
            
            <button class="reset-option" data-type="activation" onclick="selectReset('activation')">
                <div class="option-title">⚡ Gentle Activation</div>
                <div class="option-desc">Reconnect with your strength and vitality</div>
            </button>
        </div>

        <!-- Timer -->
        <div style="text-align: center; margin-bottom: 2rem;">
            <div class="timer" id="timer">10:00</div>
            <div class="progress-bar">
                <div class="progress" id="progress"></div>
            </div>
        </div>

        <!-- Current Step -->
        <div class="card">
            <div style="text-align: center; margin-bottom: 1rem;">
                <span class="step-badge" id="stepBadge">
                    Step 1 of 6
                </span>
            </div>
            
            <div class="step-timer-indicator" id="stepTimerIndicator" style="display: none;">
                <div class="step-timer-progress" id="stepTimerProgress"></div>
            </div>
            
            <p class="step-text" id="stepText">
                Notice you are safe in this moment. You have complete control.
            </p>
            
            <div class="navigation">
                <button class="button" id="prevBtn" onclick="prevStep()" disabled>
                    ← Previous
                </button>
                
                <div class="dots" id="dots"></div>
                
                <button class="button" id="nextBtn" onclick="nextStep()">
                    Next →
                </button>
            </div>
        </div>

        <!-- Controls -->
        <div class="controls">
            <button class="button" id="playBtn" onclick="togglePlay()">
                ▶ Start
            </button>
            <button class="reset-button" onclick="resetSession()">
                ↻ Reset
            </button>
        </div>

        <!-- Affirmations -->
        <div class="card">
            <h3 style="color: #2D5016; font-weight: bold; text-align: center; margin-bottom: 1.5rem; text-shadow: 1px 1px 2px rgba(255,255,255,0.5);">
                💭 Gentle Reminders
            </h3>
            <div id="affirmations"></div>
        </div>

        <!-- Footer -->
        <div style="text-align: center; font-size: 0.75rem; color: #2D5016; opacity: 0.6; margin-top: 2rem;">
            <p>This is not a substitute for professional mental health care.</p>
            <p>If you're in crisis, please reach out to a mental health professional.</p>
            <p style="font-weight: bold; margin-top: 1rem;">© 2025 Tranquility. All rights reserved.</p>
        </div>
    </div>

    <script>
        // ======== APP STATE ========
        let isPlaying = false;
        let currentStep = 0;
        let timeLeft = 10 * 60; // 10 minutes
        let selectedReset = 'grounding';
        let timer = null;
        let stepProgressTimer = null;
        let stepDuration = 15; // 15 seconds per step
        let stepTimeLeft = 15;
        let voiceEnabled = false;
        let musicEnabled = false;
        let backgroundMusic = null;
        let currentAudioElement = null;
        
        // ======== YOUR ELEVENLABS VOICE ========
        const ELEVENLABS_API_KEY = 'sk_7d893139951c8ad466e5c878f2ce5ca3fe53f512b7619d9d';
        const ELEVENLABS_VOICE_ID = 'K6rt8X9xs4hoCaJoIh1R';
        
        // ======== YOUR PIANO MUSIC ========
        const PIANO_MUSIC_URL = 'https://cdn.pixabay.com/download/audio/2024/05/28/audio_0b3cca7bb6.mp3';

        // ======== RESET TYPES DATA ========
        const resetTypes = {
            grounding: {
                name: "Grounding & Safety",
                steps: [
                    "Notice you are safe in this moment. You have complete control.",
                    "Feel your feet on the ground. Notice 5 things you can see around you.",
                    "Take a breath only as deep as feels comfortable right now.",
                    "Notice 4 things you can touch. Feel their texture and temperature.",
                    "Allow your nervous system to recognize safety in this space.",
                    "Remember: You can pause or stop anytime. You are in control."
                ]
            },
            soothing: {
                name: "Gentle Soothing",
                steps: [
                    "Place your hands wherever feels most comforting - heart, stomach, or lap.",
                    "Breathe naturally. There's no need to change or fix anything.",
                    "Send yourself compassion for whatever you're experiencing right now.",
                    "Your nervous system is working hard to protect you.",
                    "You are deserving of comfort, care, and gentleness.",
                    "Rest in this moment of self-compassion and acceptance."
                ]
            },
            activation: {
                name: "Gentle Activation",
                steps: [
                    "Gently stretch your arms above your head if it feels right.",
                    "Roll your shoulders slowly backward, releasing any tension.",
                    "Take up space in a way that feels safe and empowering.",
                    "Notice your inherent strength and remarkable resilience.",
                    "Acknowledge: You survived. You are here. You are enough.",