import React, { useState, useEffect } from 'react';
import { Play, Pause, RotateCcw, Heart, Shield, Zap } from 'lucide-react';

const TraumaInformedResetApp = () => {
  const [isPlaying, setIsPlaying] = useState(false);
  const [currentStep, setCurrentStep] = useState(0);
  const [timeLeft, setTimeLeft] = useState(10 * 60); // 10 minutes in seconds
  const [selectedReset, setSelectedReset] = useState('grounding');
  const [showSafetyReminder, setShowSafetyReminder] = useState(true);

  const resetTypes = {
    grounding: {
      name: "Grounding & Safety",
      icon: <Shield className="w-6 h-6" />,
      steps: [
        "Notice you are safe in this moment. You have complete control.",
        "Feel your feet on the ground. Notice 5 things you can see.",
        "Take a breath only as deep as feels comfortable.",
        "Notice 4 things you can touch around you.",
        "Allow your nervous system to recognize safety.",
        "You can pause or stop anytime. You are in control."
      ]
    },
    soothing: {
      name: "Gentle Soothing",
      icon: <Heart className="w-6 h-6" />,
      steps: [
        "Place your hands wherever feels comforting - heart, stomach, or lap.",
        "Breathe naturally. No need to change anything.",
        "Send yourself compassion for whatever you're feeling.",
        "Your nervous system is trying to protect you.",
        "You are worthy of comfort and care.",
        "Rest in this gentle awareness."
      ]
    },
    activation: {
      name: "Gentle Activation",
      icon: <Zap className="w-6 h-6" />,
      steps: [
        "Gently stretch your arms above your head if it feels good.",
        "Roll your shoulders slowly backward.",
        "Take up space in a way that feels safe.",
        "Notice your strength and resilience.",
        "You survived. You are here. You are enough.",
        "Feel your aliveness and presence."
      ]
    }
  };

  const affirmations = {
    grounding: [
      "I am safe in this moment",
      "I trust my ability to care for myself",
      "My feelings are valid"
    ],
    soothing: [
      "I deserve compassion",
      "I am worthy of gentleness",
      "I honor my healing journey"
    ],
    activation: [
      "I am resilient and strong",
      "I have survived difficult things",
      "I choose to honor my experience"
    ]
  };

  useEffect(() => {
    let interval;
    if (isPlaying && timeLeft > 0) {
      interval = setInterval(() => {
        setTimeLeft(timeLeft - 1);
      }, 1000);
    } else if (timeLeft === 0) {
      setIsPlaying(false);
    }
    return () => clearInterval(interval);
  }, [isPlaying, timeLeft]);

  const togglePlay = () => {
    setIsPlaying(!isPlaying);
  };

  const resetSession = () => {
    setIsPlaying(false);
    setCurrentStep(0);
    setTimeLeft(10 * 60);
  };

  const nextStep = () => {
    if (currentStep < resetTypes[selectedReset].steps.length - 1) {
      setCurrentStep(currentStep + 1);
    }
  };

  const prevStep = () => {
    if (currentStep > 0) {
      setCurrentStep(currentStep - 1);
    }
  };

  const formatTime = (seconds) => {
    const mins = Math.floor(seconds / 60);
    const secs = seconds % 60;
    return `${mins}:${secs.toString().padStart(2, '0')}`;
  };

  const currentResetType = resetTypes[selectedReset];

  // Custom Leaf Logo Component matching the TRANQUILITY brand exactly
  const TranquilityLeaf = ({ className = "w-8 h-8" }) => (
    <svg 
      className={className}
      viewBox="0 0 100 140" 
      fill="none" 
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        d="M50 20 C 25 25, 15 45, 20 75 C 25 105, 45 125, 50 130 C 55 125, 75 105, 80 75 C 85 45, 75 25, 50 20 Z"
        fill="#2D5016"
      />
      <path
        d="M50 35 L50 115"
        stroke="#D4AF37"
        strokeWidth="3"
        strokeLinecap="round"
      />
    </svg>
  );

  return (
    <div style={{ backgroundColor: '#E8E2D5' }} className="max-w-md mx-auto min-h-screen p-6 relative">
      {/* Subtle floating elements */}
      <div className="fixed inset-0 overflow-hidden pointer-events-none">
        <div className="absolute top-1/4 left-1/4 w-28 h-28 rounded-full animate-pulse opacity-8" style={{ background: 'radial-gradient(circle, #2D501630, transparent)' }}></div>
        <div className="absolute top-1/2 right-1/4 w-24 h-24 rounded-full animate-pulse opacity-6" style={{ background: 'radial-gradient(circle, #4A6741, transparent)' }}></div>
        <div className="absolute bottom-1/4 left-1/3 w-20 h-20 rounded-full animate-pulse opacity-4" style={{ background: 'radial-gradient(circle, #6B8E23, transparent)' }}></div>
        
        {/* Floating natural particles */}
        <div className="absolute top-1/5 left-1/6 w-1 h-1 rounded-full animate-bounce opacity-30" style={{ backgroundColor: '#2D5016' }}></div>
        <div className="absolute top-1/3 right-1/3 w-0.5 h-0.5 rounded-full animate-pulse opacity-40" style={{ backgroundColor: '#4A6741' }}></div>
        <div className="absolute bottom-1/3 left-1/4 w-1.5 h-1.5 rounded-full animate-bounce opacity-25" style={{ backgroundColor: '#6B8E23' }}></div>
        <div className="absolute top-2/3 right-1/5 w-0.5 h-0.5 rounded-full animate-pulse opacity-35" style={{ backgroundColor: '#2D5016' }}></div>
      </div>

      {/* Safety Notice */}
      {showSafetyReminder && (
        <div className="bg-white rounded-3xl p-6 mb-8 shadow-lg border-2" style={{ borderColor: '#4A6741' }}>
          <div className="flex items-start space-x-4">
            <div className="p-3 rounded-2xl shadow-inner" style={{ backgroundColor: '#2D501620' }}>
              <Shield className="w-6 h-6" style={{ color: '#2D5016' }} />
            </div>
            <div>
              <h3 className="font-bold text-lg mb-2" style={{ color: '#2D5016' }}>Your Safety Matters</h3>
              <p className="text-sm leading-relaxed mb-4" style={{ color: '#2D5016', opacity: 0.8 }}>
                You can pause, skip, or stop at any time. Only do what feels safe and comfortable.
              </p>
              <button 
                onClick={() => setShowSafetyReminder(false)}
                className="text-white text-sm font-bold px-6 py-2 rounded-full hover:opacity-90 transition-all duration-300 shadow-md"
                style={{ 
                  backgroundColor: '#2D5016',
                  boxShadow: '0 4px 15px rgba(45, 80, 22, 0.3)'
                }}
              >
                I understand ✓
              </button>
            </div>
          </div>
        </div>
      )}

      {/* Header with Logo */}
      <div className="text-center mb-12">
        <div className="relative flex items-center justify-center mb-6">
          <div className="relative">
            <h1 className="text-5xl font-black tracking-wider" style={{ color: '#2D5016' }}>
              TRANQUILITY<span className="text-2xl align-top ml-1" style={{ color: '#D4AF37' }}>™</span>
            </h1>
            <div className="absolute -top-10 right-8" style={{ transform: 'rotate(25deg)' }}>
              <TranquilityLeaf className="w-10 h-12" />
            </div>
          </div>
        </div>
        <div className="w-40 h-1.5 mx-auto mb-3 rounded-full shadow-lg" style={{ 
          background: 'linear-gradient(90deg, #D4AF37 0%, #2D5016 50%, #D4AF37 100%)',
          boxShadow: '0 0 10px rgba(212, 175, 55, 0.4)'
        }}></div>
        <p className="text-lg font-medium" style={{ color: '#2D5016', opacity: 0.7 }}>Soothe the Nervous System, Feel the Calm.</p>
      </div>

      {/* Reset Type Selection */}
      <div className="mb-12">
        <p className="font-bold mb-6 text-center text-xl" style={{ color: '#2D5016' }}>Choose your reset type:</p>
        <div className="space-y-5">
          {Object.entries(resetTypes).map(([key, reset]) => (
            <button
              key={key}
              onClick={() => setSelectedReset(key)}
              className={`w-full p-6 rounded-3xl border-2 transition-all duration-300 transform hover:scale-[1.02] shadow-md hover:shadow-lg ${
                selectedReset === key 
                  ? 'text-white shadow-xl' 
                  : 'hover:shadow-lg'
              }`}
              style={{
                backgroundColor: selectedReset === key ? '#2D5016' : 'white',
                borderColor: selectedReset === key ? '#D4AF37' : '#D4AF3780',
                color: selectedReset === key ? 'white' : '#2D5016',
                boxShadow: selectedReset === key 
                  ? '0 8px 25px rgba(45, 80, 22, 0.3)' 
                  : '0 4px 15px rgba(74, 103, 65, 0.15)'
              }}
            >
              <div className="flex items-center space-x-5">
                <div 
                  className="p-4 rounded-2xl transition-all duration-300 shadow-inner"
                  style={{
                    backgroundColor: selectedReset === key ? '#D4AF3750' : '#2D501620'
                  }}
                >
                  {reset.icon}
                </div>
                <span className="font-bold text-xl">{reset.name}</span>
              </div>
            </button>
          ))}
        </div>
      </div>

      {/* Timer */}
      <div className="text-center mb-12">
        <div className="text-7xl font-black mb-6" style={{ 
          color: '#2D5016'
        }}>
          {formatTime(timeLeft)}
        </div>
        <div className="w-full bg-white rounded-full h-5 overflow-hidden shadow-inner border-2" style={{ 
          borderColor: '#D4AF37'
        }}>
          <div 
            className="h-5 rounded-full transition-all duration-500"
            style={{ 
              background: `linear-gradient(90deg, #2D5016 0%, #D4AF37 50%, #2D5016 100%)`,
              width: `${((10 * 60 - timeLeft) / (10 * 60)) * 100}%`,
              boxShadow: '0 0 15px rgba(212, 175, 55, 0.6)'
            }}
          />
        </div>
      </div>

      {/* Current Step */}
      <div className="bg-white rounded-3xl p-8 mb-12 shadow-xl border-2" style={{ 
        borderColor: '#D4AF37'
      }}>
        <div className="text-center mb-8">
          <div className="flex justify-center mb-4">
            <span 
              className="inline-block px-8 py-3 rounded-2xl text-sm font-bold text-white shadow-lg"
              style={{ 
                backgroundColor: '#2D5016',
                boxShadow: '0 6px 20px rgba(212, 175, 55, 0.4)'
              }}
            >
              Step {currentStep + 1} of {currentResetType.steps.length}
            </span>
          </div>
        </div>
        <p className="text-2xl leading-relaxed text-center mb-10 font-medium" style={{ color: '#2D5016' }}>
          {currentResetType.steps[currentStep]}
        </p>
        
        {/* Step Navigation */}
        <div className="flex justify-between items-center">
          <button
            onClick={prevStep}
            disabled={currentStep === 0}
            className="px-8 py-4 text-sm rounded-2xl font-bold disabled:opacity-30 hover:opacity-80 transition-all duration-300 shadow-sm text-white"
            style={{ 
              backgroundColor: '#4A6741'
            }}
          >
            ← Previous
          </button>
          <div className="flex space-x-3">
            {currentResetType.steps.map((_, index) => (
              <div
                key={index}
                className="w-3 h-3 rounded-full transition-all duration-500"
                style={{ 
                  backgroundColor: index === currentStep ? '#D4AF37' : '#4A674160',
                  boxShadow: index === currentStep ? '0 0 12px rgba(212, 175, 55, 0.8)' : 'none'
                }}
              />
            ))}
          </div>
          <button
            onClick={nextStep}
            disabled={currentStep === currentResetType.steps.length - 1}
            className="px-8 py-4 text-sm rounded-2xl font-bold disabled:opacity-30 hover:opacity-80 transition-all duration-300 shadow-sm text-white"
            style={{ 
              backgroundColor: '#4A6741'
            }}
          >
            Next →
          </button>
        </div>
      </div>

      {/* Controls */}
      <div className="flex justify-center space-x-6 mb-12">
        <button
          onClick={togglePlay}
          className="flex items-center space-x-4 px-12 py-5 rounded-3xl text-white font-black text-xl hover:opacity-90 transition-all duration-300 transform hover:scale-105 shadow-xl"
          style={{ 
            backgroundColor: '#2D5016',
            boxShadow: '0 10px 30px rgba(212, 175, 55, 0.4)'
          }}
        >
          {isPlaying ? <Pause className="w-8 h-8" /> : <Play className="w-8 h-8" />}
          <span>{isPlaying ? 'Pause' : 'Start'}</span>
        </button>
        <button
          onClick={resetSession}
          className="flex items-center space-x-4 px-12 py-5 bg-white rounded-3xl hover:opacity-90 transition-all duration-300 transform hover:scale-105 border-2 font-black text-xl shadow-xl"
          style={{ 
            borderColor: '#D4AF37',
            color: '#2D5016'
          }}
        >
          <RotateCcw className="w-8 h-8" />
          <span>Reset</span>
        </button>
      </div>

      {/* Affirmations */}
      <div className="bg-white rounded-3xl p-8 shadow-xl border-2" style={{ 
        borderColor: '#D4AF37'
      }}>
        <h3 className="font-black mb-8 text-center text-2xl" style={{ color: '#2D5016' }}>Gentle Reminders</h3>
        <div className="space-y-6">
          {affirmations[selectedReset].map((affirmation, index) => (
            <div 
              key={index} 
              className="flex items-center space-x-5 p-5 rounded-2xl border"
              style={{ 
                backgroundColor: '#D4AF3730',
                borderColor: '#D4AF3760'
              }}
            >
              <TranquilityLeaf className="w-5 h-6" />
              <span className="font-semibold italic text-lg" style={{ color: '#2D5016' }}>{affirmation}</span>
            </div>
          ))}
        </div>
      </div>

      {/* Footer */}
      <div className="mt-12 text-center text-sm space-y-3" style={{ color: '#2D5016', opacity: 0.6 }}>
        <p>This is not a substitute for professional mental health care.</p>
        <p>If you're in crisis, please reach out to a mental health professional.</p>
        <div className="w-20 h-0.5 mx-auto my-4 rounded-full shadow-sm" style={{ 
          background: 'linear-gradient(90deg, #D4AF37 0%, #2D5016 50%, #D4AF37 100%)',
          boxShadow: '0 0 8px rgba(212, 175, 55, 0.4)'
        }}></div>
        <p className="font-bold" style={{ color: '#2D5016' }}>© 2025 Tranquility. All rights reserved.</p>
      </div>
    </div>
  );
};

export default TraumaInformedResetApp;